{% extends 'base.html' %}

{% block body %}
<div class="main-container">
	<h2 id="queryName">Query: </h2>
	<div id="PCAscatter" style="width:600px; height:600px;"></div>
</div>
{% endblock %}

{% block javascript %}
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="http://code.highcharts.com/highcharts-3d.js"></script>
	<script src="http://code.highcharts.com/modules/heatmap.js"></script>

	<script type="text/javascript">
	  	$(function () {
	  		$.ajax({
	  			url: "/search?query={{ query }}",
	  			dataType: "json"
	  		}).done(function(data) {
	  			$("#queryName").text("Query: '" + data.query + "'");
	  			var series = data.results.map(function(result) {
	  				return {
	  					name: result.query + ", "+ result.language,
	  					data: result.results
	  				}
	  			});

	  			$('#PCAscatter').highcharts({
			        chart: {
			            type: 'scatter'
			        },
		        	legend: {
			            layout: 'vertical',
			            align: 'left',
			            verticalAlign: 'top',
			            x: 100,
			            y: 70,
			            floating: true,
			            backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF',
			            borderWidth: 1
			        },
			        xAxis: {
			            title: {
			                enabled: false
			            },
			        },
			        yAxis: {
			            title: {
			                enabled: false
			            }
			        },
			        title: {
			            text: 'Tonality clustering'
			        },
			        subtitle: {
			            text: 'Reduced to 2 dimensions through PCA'
			        },
			        series: series
			    });
	  		});
	  });
	</script>
{% endblock %}